# ========================================
# ORDER SERVICE CONFIGURATION
# ========================================
quarkus.http.port=8080

# Disable interactive console
quarkus.console.enabled=false

# ========================================
# DATABASE - POSTGRESQL
# ========================================
quarkus.datasource.db-kind=postgresql
%prod.quarkus.datasource.jdbc.url=${QUARKUS_DATASOURCE_JDBC_URL:jdbc:postgresql://localhost:5432/orderdb}
%prod.quarkus.datasource.username=${QUARKUS_DATASOURCE_USERNAME:admin}
%prod.quarkus.datasource.password=${QUARKUS_DATASOURCE_PASSWORD:admin123}

# Connection pool
quarkus.datasource.jdbc.min-size=5
quarkus.datasource.jdbc.max-size=20

# ========================================
# HIBERNATE ORM
# ========================================
# Dev - Validate schema only (Flyway manages migrations)
%dev.quarkus.hibernate-orm.database.generation=validate
%dev.quarkus.hibernate-orm.sql-load-script=no-file
%dev.quarkus.hibernate-orm.log.sql=true

# Test - Drop and recreate (in-memory database)
%test.quarkus.hibernate-orm.database.generation=drop-and-create

# Production - Validate only (Flyway already applied)
%prod.quarkus.hibernate-orm.database.generation=validate
%prod.quarkus.hibernate-orm.log.sql=false

# ========================================
# FLYWAY (Database Migrations)
# ========================================
quarkus.flyway.migrate-at-start=true
quarkus.flyway.baseline-on-migrate=true
quarkus.flyway.baseline-version=0

# ========================================
# KAFKA
# ========================================
%prod.kafka.bootstrap.servers=${KAFKA_BOOTSTRAP_SERVERS:localhost:9093}

# ========================================
# KAFKA PRODUCERS
# ========================================
# Producer - Order Created
mp.messaging.outgoing.order-created.connector=smallrye-kafka
mp.messaging.outgoing.order-created.topic=order-created
mp.messaging.outgoing.order-created.value.serializer=io.quarkus.kafka.client.serialization.ObjectMapperSerializer
mp.messaging.outgoing.order-created.acks=1

# Producer - Order Status Changed
mp.messaging.outgoing.order-status-changed.connector=smallrye-kafka
mp.messaging.outgoing.order-status-changed.topic=order-status-changed
mp.messaging.outgoing.order-status-changed.value.serializer=io.quarkus.kafka.client.serialization.ObjectMapperSerializer
mp.messaging.outgoing.order-status-changed.acks=1

# ========================================
# OBSERVABILITY
# ========================================
# Health Check
quarkus.smallrye-health.root-path=/q/health

# Metrics
quarkus.micrometer.export.prometheus.enabled=true
quarkus.micrometer.export.prometheus.path=/q/metrics

# ========================================
# LOGGING
# ========================================
quarkus.log.level=INFO
quarkus.log.category."com.ecommerce".level=DEBUG
quarkus.log.console.format=%d{HH:mm:ss} %-5p [%c{2.}] (%t) %s%e%n

# JSON logs (disabled by default, enabled in production)
quarkus.log.console.json=false

# ========================================
# PROFILE: PRODUCTION
# ========================================
%prod.quarkus.log.console.json=true
%prod.quarkus.log.level=INFO
%prod.quarkus.log.category."com.ecommerce".level=INFO